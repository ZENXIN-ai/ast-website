<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AST — 去中心化AI代币</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  /* 精简 + 升级的主题变量 */
  :root{
    --bg-main:#060712;
    --bg-grad: linear-gradient(135deg,#0b0f1a 0%, #0f1724 100%);
    --card:#0f1620cc;
    --glass: rgba(255,255,255,0.03);
    --accent:#00f6ff;
    --neon-grad: linear-gradient(90deg,#00f6ff,#4df1ff,#dffaff);
    --text:#e8eef6;
    --muted: rgba(232,238,246,0.6);
    --radius:12px;
    --transition: all .22s cubic-bezier(.2,.9,.3,1);
  }

  html,body{height:100%;margin:0;font-family:Inter, "PingFang SC", "Microsoft YaHei", sans-serif;background:var(--bg-grad);color:var(--text);-webkit-font-smoothing:antialiased;}

  /* container */
  .wrap{max-width:1200px;margin:0 auto;padding:28px;}

  header.navbar{display:flex;align-items:center;justify-content:space-between;padding:18px;border-radius:10px;}
  .brand{display:flex;gap:14px;align-items:center}
  .logo{width:48px;height:48px;border-radius:10px;background:var(--neon-grad);display:flex;align-items:center;justify-content:center;color:#001; font-weight:700;box-shadow:0 8px 30px rgba(0,246,255,0.06)}
  .brand-title{font-size:20px;color:var(--accent);font-weight:700}
  .nav{display:flex;gap:18px;align-items:center}
  .nav a{color:var(--muted);text-decoration:none;font-weight:500}
  .nav a:hover{color:var(--accent)}

  .hero{display:flex;gap:28px;align-items:center;margin-top:18px}
  .hero-left{flex:1}
  h1{font-size:44px;margin:0 0 12px 0;background:var(--neon-grad);-webkit-background-clip:text;color:transparent;font-weight:800;line-height:1.05}
  .lead{color:var(--muted);font-size:16px;margin-bottom:18px}

  .cta{display:flex;gap:12px}
  .btn{padding:10px 16px;border-radius:10px;border:none;cursor:pointer;font-weight:700;transition:var(--transition)}
  .btn.primary{background:linear-gradient(90deg,#5b5bff,#00d4ff);color:#001}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}

  /* right card */
  .hero-right{width:320px;background:var(--card);border-radius:14px;padding:18px;box-shadow:0 12px 30px rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.03)}
  .hero-right dl{display:grid;grid-template-columns:1fr 1fr;gap:6px;color:var(--muted)}

  /* sections */
  .section{margin-top:22px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.02);}

  /* CHAT UI */
  #origin-core-chat{
    position:fixed;right:20px;bottom:20px;width:360px;border-radius:14px;background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));backdrop-filter: blur(8px);
    border:1px solid rgba(0,246,255,0.06);box-shadow:0 30px 60px rgba(2,6,23,0.6);overflow:hidden;z-index:1000;
  }
  .oc-header{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid rgba(255,255,255,0.02)}
  .oc-header h4{margin:0;color:var(--accent);font-size:14px}
  #oc-messages{height:320px;overflow:auto;padding:12px;display:flex;flex-direction:column;gap:10px}
  .message{max-width:78%;padding:10px 12px;border-radius:12px;line-height:1.35;word-break:break-word;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
  .user-message{margin-left:auto;background:linear-gradient(180deg,#06121a,#07202a);border:1px solid rgba(0,198,255,0.06)}
  .bot-message{margin-right:auto;background:linear-gradient(180deg,#0d1230,#0b1530);border:1px solid rgba(124,42,232,0.06)}
  .message-sender{font-size:11px;color:var(--muted);margin-bottom:6px}
  .oc-input-box{display:flex;gap:8px;padding:12px;border-top:1px solid rgba(255,255,255,0.02)}
  #oc-input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text);outline:none}
  #oc-send{padding:10px 12px;border-radius:10px;background:linear-gradient(90deg,#00f6ff,#7c2ae8);border:none;color:#001;font-weight:700;cursor:pointer}

  .typing-indicator{display:flex;align-items:center;gap:6px;color:var(--muted);font-size:13px}
  .typing-dot{width:6px;height:6px;border-radius:50%;background:var(--accent);opacity:.6;animation:typing 1.2s infinite;}

  @keyframes typing{0%{transform:scale(1);opacity:.4}50%{transform:scale(1.3);opacity:1}100%{transform:scale(1);opacity:.4}}

  /* admin panel (overlay) */
  #admin-panel{display:none;position:fixed;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.7));z-index:2000;align-items:center;justify-content:center;padding:28px}
  .admin-card{max-width:1000px;width:100%;background:rgba(255,255,255,0.02);border-radius:14px;padding:26px;border:1px solid rgba(0,246,255,0.05);box-shadow:0 30px 80px rgba(0,0,0,0.6)}

  /* responsive */
  @media (max-width:900px){.hero{flex-direction:column}.hero-right{width:100%}}
  @media (max-width:480px){#origin-core-chat{width:calc(100% - 32px);right:16px;bottom:16px}}
</style>
</head>
<body>
  <div class="wrap">
    <header class="navbar">
      <div class="brand">
        <div class="logo">AST</div>
        <div>
          <div class="brand-title">AST</div>
          <div class="brand-sub" style="color:var(--muted);font-size:13px">去中心化AI代币</div>
        </div>
      </div>
      <nav class="nav">
        <a href="#about">关于</a>
        <a href="#tokenomics">代币经济</a>
        <a href="#roadmap">路线图</a>
        <a href="#contact">联系我们</a>
      </nav>
    </header>

    <section class="hero">
      <div class="hero-left">
        <h1>AI奖励的未来</h1>
        <p class="lead">训练您的AI。赚取AST。一个为奖励智能代理进化而构建的去中心化代币。</p>
        <div class="cta">
          <a class="btn primary" href="#tokenomics">查看代币经济</a>
          <a class="btn ghost" href="#roadmap">查看路线图</a>
        </div>
      </div>

      <aside class="hero-right">
        <h4 style="margin:0 0 8px 0;color:var(--accent)">AST 快速信息</h4>
        <dl>
          <dt style="color:var(--muted)">网络</dt><dd>Base Sepolia (测试网)</dd>
          <dt style="color:var(--muted)">符号</dt><dd>AST</dd>
          <dt style="color:var(--muted)">总供应量</dt><dd>1,000,000,000</dd>
        </dl>
        <div style="margin-top:12px">
          <button class="btn ghost" id="open-admin-from-card">管理员</button>
        </div>
      </aside>
    </section>

    <section id="about" class="section"><h3 style="margin-top:0;color:var(--accent)">什么是AST?</h3>
      <p style="color:var(--muted)">AST是一个面向自主代理、数据训练师、模型贡献者和下一代AI生态系统的去中心化AI实用代币。</p>
    </section>

    <section id="tokenomics" class="section">
      <h3 style="color:var(--accent)">代币经济</h3>
      <ul style="color:var(--muted)">
        <li>总供应量: 1,000,000,000 AST</li>
        <li>AI训练奖励: 40%</li>
        <li>生态系统发展: 25%</li>
      </ul>
    </section>
  </div>

  <!-- CHAT WIDGET -->
  <div id="origin-core-chat" role="region" aria-label="AST chat widget">
    <div class="oc-header">
      <h4>AST Origin Core</h4>
      <div>
        <button id="oc-minimize" aria-label="minimize">−</button>
      </div>
    </div>

    <div id="oc-messages" aria-live="polite"></div>

    <div class="oc-input-box">
      <input id="oc-input" type="text" placeholder="询问关于AST代币..." aria-label="chat input" />
      <button id="oc-send">发送</button>
    </div>
  </div>

  <!-- ADMIN PANEL -->
  <div id="admin-panel" aria-hidden="true">
    <div class="admin-card" role="dialog" aria-modal="true">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h2 style="margin:0;color:var(--accent)">AST 管理面板</h2>
        <div>
          <span id="currentTime" style="color:var(--muted);margin-right:12px"></span>
          <button id="adminClose" class="btn ghost">关闭</button>
        </div>
      </div>

      <div style="margin-top:18px">
        <p style="color:var(--muted)">（管理操作为示例 —— 实际上线请通过后端验证 & 权限控制）</p>
        <div style="display:flex;gap:12px;margin-top:12px">
          <button class="btn primary" id="issueBtn">模拟发行代币</button>
          <button class="btn primary" id="airdropBtn">模拟空投</button>
          <button class="btn ghost" id="burnBtn">模拟销毁</button>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  /* ---------- Utilities ---------- */
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));

  /* ---------- Admin Panel ---------- */
  const adminPanel = $('#admin-panel');
  const adminCloseBtn = $('#adminClose');
  const openAdminFromCard = $('#open-admin-from-card');

  function openAdminPanel() {
    if (!adminPanel) return;
    adminPanel.style.display = 'flex';
    adminPanel.setAttribute('aria-hidden','false');
    document.body.style.overflow = 'hidden';
    updateAdminTime();
  }
  function closeAdminPanel() {
    if (!adminPanel) return;
    adminPanel.style.display = 'none';
    adminPanel.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }
  if (adminCloseBtn) adminCloseBtn.addEventListener('click', closeAdminPanel);
  if (openAdminFromCard) openAdminFromCard.addEventListener('click', openAdminPanel);

  // keyboard shortcuts
  document.addEventListener('keydown', (e) => {
    if (e.ctrlKey && e.altKey && e.key.toLowerCase() === 'a') { e.preventDefault(); openAdminPanel(); }
    if (e.key === 'Escape') { closeAdminPanel(); toggleMinimize(false); }
  });

  function updateAdminTime() {
    const el = document.getElementById('currentTime');
    if (!el) return;
    el.textContent = new Date().toLocaleString('zh-CN');
  }
  setInterval(updateAdminTime, 1000);

  /* ---------- Chat widget ---------- */
  class OriginCoreChat {
    constructor() {
      this.container = $('#origin-core-chat');
      this.messagesEl = $('#oc-messages');
      this.input = $('#oc-input');
      this.sendBtn = $('#oc-send');
      this.minBtn = $('#oc-minimize');
      this.typingEl = null;
      this.init();
    }

    init() {
      if (this.sendBtn) this.sendBtn.addEventListener('click', () => this.handleSend());
      if (this.input) this.input.addEventListener('keypress', (e) => { if (e.key === 'Enter') this.handleSend(); });
      if (this.minBtn) this.minBtn.addEventListener('click', () => this.toggleMinimize());
      // welcome message
      setTimeout(() => this.addMessage('Origin Core', 'AST Origin Core 已在线。请问您需要什么帮助？', 'bot-message'), 900);
    }

    toggleMinimize(forceClose){
      const el = this.container;
      if (!el) return;
      if (forceClose === false) { el.classList.add('chat-minimized'); this.minBtn.textContent = '+'; return; }
      el.classList.toggle('chat-minimized');
      this.minBtn.textContent = el.classList.contains('chat-minimized') ? '+' : '−';
    }

    addMessage(sender, content, cls='bot-message'){
      const wrap = document.createElement('div');
      wrap.className = 'message ' + cls;
      const sEl = document.createElement('div'); sEl.className = 'message-sender'; sEl.textContent = sender + ':';
      const cEl = document.createElement('div'); cEl.className = 'message-content'; cEl.textContent = content;
      wrap.appendChild(sEl); wrap.appendChild(cEl);
      if (this.messagesEl) {
        this.messagesEl.appendChild(wrap);
        this.messagesEl.scrollTop = this.messagesEl.scrollHeight;
      }
    }

    showTyping(){
      if (!this.messagesEl) return;
      if (this.typingEl) return;
      const el = document.createElement('div');
      el.id = 'typing-indicator';
      el.className = 'typing-indicator';
      el.innerHTML = 'Origin Core 正在输入 <span class="typing-dot"></span><span class="typing-dot"></span><span class="typing-dot"></span>';
      this.typingEl = el;
      this.messagesEl.appendChild(el);
      this.messagesEl.scrollTop = this.messagesEl.scrollHeight;
    }

    hideTyping(){
      if (!this.typingEl) return;
      this.typingEl.remove();
      this.typingEl = null;
    }

    sanitizeInput(txt){
      // basic sanitize (strip invisible)
      return txt.replace(/\s+/g,' ').trim();
    }

    async handleSend(){
      const raw = this.input.value || '';
      const message = this.sanitizeInput(raw);
      if (!message) return;
      this.input.value = '';
      this.addMessage('您', message, 'user-message');

      // special admin command (local demo)
      if (message === 'AST-Origin-Core:Awaken') {
        this.addMessage('Origin Core', '系统管理员权限已激活。正在打开管理面板...', 'bot-message');
        openAdminPanel();
        return;
      }

      // call real AI endpoint
      this.showTyping();
      this.sendBtn.disabled = true;
      try {
        const reply = await sendToAI(message);
        this.hideTyping();
        this.addMessage('Origin Core', reply, 'bot-message');
      } catch (err) {
        this.hideTyping();
        console.error(err);
        this.addMessage('Origin Core', '抱歉，AI 服务暂时不可用。', 'bot-message');
      } finally {
        this.sendBtn.disabled = false;
        this.input.focus();
      }
    }
  }

  const chat = new OriginCoreChat();

  /* ---------- Front -> Backend AI call ---------- */
  async function sendToAI(userMsg){
    // endpoint: /api/chat (see server.js below)
    const res = await fetch('/api/chat', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ message: userMsg })
    });
    if (!res.ok) {
      const txt = await res.text();
      throw new Error('AI API error: ' + (txt || res.status));
    }
    const json = await res.json();
    // Expect { reply: "..." }
    return json.reply || '抱歉，未收到回应。';
  }

  /* ---------- Admin action placeholders (demo) ---------- */
  $('#issueBtn')?.addEventListener('click', () => alert('模拟：发行代币（仅演示，实际请调用后端并验证权限）'));
  $('#airdropBtn')?.addEventListener('click', () => alert('模拟：空投代币（仅演示）'));
  $('#burnBtn')?.addEventListener('click', () => {
    if (confirm('确认销毁示例代币？（模拟）')) alert('已模拟销毁。');
  });

  // set year for any footer (if exists)
  const yearSpan = document.getElementById('year');
  if (yearSpan) yearSpan.textContent = new Date().getFullYear();

  // optional: check ?admin=true in URL
  (function checkAdminParam(){ try{ const url = new URL(location.href); if (url.searchParams.get('admin') === 'true') openAdminPanel(); }catch(e){} })();

})();
</script>
</body>
</html>